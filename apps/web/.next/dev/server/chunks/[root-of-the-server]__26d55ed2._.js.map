{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GS-LP-003/Documents/Personal/my-portfolio-website/packages/db/src/schema.ts"],"sourcesContent":["import { pgTable, text, timestamp, uuid, boolean, jsonb } from \"drizzle-orm/pg-core\";\r\nimport { relations } from \"drizzle-orm\";\r\n\r\nexport const users = pgTable(\"users\", {\r\n    id: text(\"id\").primaryKey(), // Changed from uuid to text for better-auth compatibility\r\n    name: text(\"name\").notNull(),\r\n    email: text(\"email\").notNull().unique(),\r\n    emailVerified: boolean(\"email_verified\").default(false),\r\n    image: text(\"image\"),\r\n    role: text(\"role\").$type<\"admin\" | \"user\">().default(\"user\"),\r\n    createdAt: timestamp(\"created_at\").defaultNow(),\r\n    updatedAt: timestamp(\"updated_at\").defaultNow(),\r\n});\r\n\r\nexport const sessions = pgTable(\"session\", {\r\n    id: text(\"id\").primaryKey(),\r\n    token: text(\"token\"), // Made nullable - better-auth may not always provide token\r\n    expiresAt: timestamp(\"expires_at\").notNull(),\r\n    ipAddress: text(\"ip_address\"),\r\n    userAgent: text(\"user_agent\"),\r\n    userId: text(\"user_id\").notNull().references(() => users.id),\r\n    createdAt: timestamp(\"created_at\").defaultNow(),\r\n    updatedAt: timestamp(\"updated_at\").defaultNow(),\r\n});\r\n\r\nexport const accounts = pgTable(\"account\", {\r\n    id: text(\"id\").primaryKey(),\r\n    accountId: text(\"account_id\").notNull(),\r\n    providerId: text(\"provider_id\").notNull(),\r\n    userId: text(\"user_id\").notNull().references(() => users.id),\r\n    accessToken: text(\"access_token\"),\r\n    refreshToken: text(\"refresh_token\"),\r\n    idToken: text(\"id_token\"),\r\n    accessTokenExpiresAt: timestamp(\"access_token_expires_at\"),\r\n    refreshTokenExpiresAt: timestamp(\"refresh_token_expires_at\"),\r\n    scope: text(\"scope\"),\r\n    password: text(\"password\"),\r\n    createdAt: timestamp(\"created_at\").defaultNow(),\r\n    updatedAt: timestamp(\"updated_at\").defaultNow(),\r\n});\r\n\r\nexport const verifications = pgTable(\"verification\", {\r\n    id: text(\"id\").primaryKey(),\r\n    identifier: text(\"identifier\").notNull(),\r\n    value: text(\"value\").notNull(),\r\n    expiresAt: timestamp(\"expires_at\").notNull(),\r\n    createdAt: timestamp(\"created_at\").defaultNow(),\r\n    updatedAt: timestamp(\"updated_at\").defaultNow(),\r\n});\r\n\r\nexport const blogs = pgTable(\"blogs\", {\r\n    id: uuid(\"id\").primaryKey().defaultRandom(),\r\n    slug: text(\"slug\").notNull().unique(),\r\n    title: text(\"title\").notNull(),\r\n    excerpt: text(\"excerpt\"),\r\n    content: text(\"content\").notNull(), // HTML content from WYSIWYG\r\n    coverImage: text(\"cover_image\"),\r\n    thumbnail: text(\"thumbnail\"),\r\n    authorId: text(\"author_id\").references(() => users.id),\r\n    category: text(\"category\"), // Added category field\r\n    published: boolean(\"published\").default(false),\r\n    tags: jsonb(\"tags\").$type<string[]>(),\r\n    readingTime: text(\"reading_time\"),\r\n    createdAt: timestamp(\"created_at\").defaultNow(),\r\n    updatedAt: timestamp(\"updated_at\").defaultNow(),\r\n});\r\n\r\nexport const projects = pgTable(\"projects\", {\r\n    id: uuid(\"id\").primaryKey().defaultRandom(),\r\n    slug: text(\"slug\").notNull().unique(),\r\n    title: text(\"title\").notNull(),\r\n    description: text(\"description\"),\r\n    content: text(\"content\"), // Scrollytelling content or rich text\r\n    coverImage: text(\"cover_image\"),\r\n    thumbnail: text(\"thumbnail\"),\r\n    images: jsonb(\"images\").$type<string[]>(), // Gallery images\r\n    techStack: jsonb(\"tech_stack\").$type<string[]>(),\r\n    repoUrl: text(\"repo_url\"),\r\n    demoUrl: text(\"demo_url\"),\r\n    published: boolean(\"published\").default(false),\r\n    createdAt: timestamp(\"created_at\").defaultNow(),\r\n    updatedAt: timestamp(\"updated_at\").defaultNow(),\r\n});\r\n\r\n// Define relations for Drizzle relational queries\r\nexport const usersRelations = relations(users, ({ many }) => ({\r\n    blogs: many(blogs),\r\n    sessions: many(sessions),\r\n    accounts: many(accounts),\r\n}));\r\n\r\nexport const blogsRelations = relations(blogs, ({ one }) => ({\r\n    author: one(users, {\r\n        fields: [blogs.authorId],\r\n        references: [users.id],\r\n    }),\r\n}));\r\n\r\nexport const sessionsRelations = relations(sessions, ({ one }) => ({\r\n    user: one(users, {\r\n        fields: [sessions.userId],\r\n        references: [users.id],\r\n    }),\r\n}));\r\n\r\nexport const accountsRelations = relations(accounts, ({ one }) => ({\r\n    user: one(users, {\r\n        fields: [accounts.userId],\r\n        references: [users.id],\r\n    }),\r\n}));\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 233, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GS-LP-003/Documents/Personal/my-portfolio-website/packages/db/src/db.ts"],"sourcesContent":["import { drizzle, PostgresJsDatabase } from 'drizzle-orm/postgres-js';\r\nimport postgres from 'postgres';\r\nimport * as schema from './schema';\r\n\r\nlet _db: PostgresJsDatabase<typeof schema> | null = null;\r\n\r\nexport function getDb(): PostgresJsDatabase<typeof schema> {\r\n    if (!_db) {\r\n        const connectionString = process.env.DATABASE_URL;\r\n\r\n        if (!connectionString) {\r\n            throw new Error('DATABASE_URL is missing in environment variables');\r\n        }\r\n\r\n        const client = postgres(connectionString, {\r\n            ssl: { rejectUnauthorized: false },\r\n            prepare: false, // Required for Supabase Transaction connection pooler (port 6543)\r\n        });\r\n\r\n        _db = drizzle(client, { schema });\r\n    }\r\n    return _db;\r\n}\r\n\r\n// Re-export for backwards compatibility (lazily initialized)\r\nexport const db = new Proxy({} as PostgresJsDatabase<typeof schema>, {\r\n    get(_, prop) {\r\n        return (getDb() as any)[prop];\r\n    }\r\n});\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEA,IAAI,MAAgD;AAE7C,SAAS;IACZ,IAAI,CAAC,KAAK;QACN,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;QAEjD,IAAI,CAAC,kBAAkB;YACnB,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,SAAS,IAAA,qJAAQ,EAAC,kBAAkB;YACtC,KAAK;gBAAE,oBAAoB;YAAM;YACjC,SAAS;QACb;QAEA,MAAM,IAAA,uKAAO,EAAC,QAAQ;YAAE,QAAA;QAAO;IACnC;IACA,OAAO;AACX;AAGO,MAAM,KAAK,IAAI,MAAM,CAAC,GAAwC;IACjE,KAAI,CAAC,EAAE,IAAI;QACP,OAAO,AAAC,OAAe,CAAC,KAAK;IACjC;AACJ"}},
    {"offset": {"line": 273, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GS-LP-003/Documents/Personal/my-portfolio-website/packages/db/src/client.ts"],"sourcesContent":["import { createClient, SupabaseClient } from '@supabase/supabase-js';\r\n\r\nlet _supabase: SupabaseClient | null = null;\r\n\r\nexport function getSupabase(): SupabaseClient {\r\n    if (!_supabase) {\r\n        const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n        const supabaseKey = process.env.SUPABASE_SERVICE_ROLE_KEY || process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY;\r\n\r\n        if (!supabaseUrl || !supabaseKey) {\r\n            throw new Error('Supabase URL or Key missing in environment variables');\r\n        }\r\n\r\n        _supabase = createClient(supabaseUrl, supabaseKey);\r\n    }\r\n    return _supabase;\r\n}\r\n\r\n// Re-export for backwards compatibility (lazily initialized)\r\nexport const supabase = new Proxy({} as SupabaseClient, {\r\n    get(_, prop) {\r\n        return (getSupabase() as any)[prop];\r\n    }\r\n});\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,IAAI,YAAmC;AAEhC,SAAS;IACZ,IAAI,CAAC,WAAW;QACZ,MAAM,cAAc,QAAQ,GAAG,CAAC,wBAAwB;QACxD,MAAM,cAAc,QAAQ,GAAG,CAAC,yBAAyB,IAAI,QAAQ,GAAG,CAAC,4CAA4C;QAErH,IAAI,CAAC,eAAe,CAAC,aAAa;YAC9B,MAAM,IAAI,MAAM;QACpB;QAEA,YAAY,IAAA,gMAAY,EAAC,aAAa;IAC1C;IACA,OAAO;AACX;AAGO,MAAM,WAAW,IAAI,MAAM,CAAC,GAAqB;IACpD,KAAI,CAAC,EAAE,IAAI;QACP,OAAO,AAAC,aAAqB,CAAC,KAAK;IACvC;AACJ"}},
    {"offset": {"line": 302, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GS-LP-003/Documents/Personal/my-portfolio-website/packages/db/src/index.ts"],"sourcesContent":["export * from './schema';\r\nexport * from './db';\r\nexport * from './client';\r\n"],"names":[],"mappings":";AAAA;AACA;AACA"}},
    {"offset": {"line": 313, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GS-LP-003/Documents/Personal/my-portfolio-website/apps/web/lib/db.ts"],"sourcesContent":["// Re-export database from shared package for use in API routes\r\nexport * from '@repo/db';\r\n"],"names":[],"mappings":";AAAA,+DAA+D;AAC/D"}},
    {"offset": {"line": 321, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GS-LP-003/Documents/Personal/my-portfolio-website/apps/web/app/api/blogs/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { db, blogs } from '@/lib/db';\r\nimport { desc } from 'drizzle-orm';\r\n\r\n// GET /api/blogs - List all blogs with author\r\nexport async function GET() {\r\n    try {\r\n        if (!process.env.DATABASE_URL) {\r\n            console.warn('DATABASE_URL is missing, returning empty list (build mode?)');\r\n            return NextResponse.json([]);\r\n        }\r\n\r\n        const data = await db.query.blogs.findMany({\r\n            orderBy: [desc(blogs.createdAt)],\r\n            with: {\r\n                author: true\r\n            }\r\n        });\r\n\r\n        const mappedData = data.map(blog => ({\r\n            ...blog,\r\n            author: blog.author || { name: 'Unknown', role: 'Author', avatar: '' }\r\n        }));\r\n\r\n        return NextResponse.json(mappedData);\r\n    } catch (error: any) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n\r\n// POST /api/blogs - Create new blog\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const body = await request.json();\r\n\r\n        const blogData = {\r\n            title: body.title,\r\n            slug: body.slug,\r\n            excerpt: body.excerpt,\r\n            content: body.content,\r\n            category: body.category,\r\n            coverImage: body.cover_image,\r\n            thumbnail: body.cover_image,\r\n            tags: body.tags,\r\n            readingTime: body.reading_time,\r\n            published: body.published,\r\n            authorId: body.author_id,\r\n        };\r\n\r\n        const data = await db.insert(blogs).values(blogData).returning();\r\n        return NextResponse.json(data[0]);\r\n    } catch (error: any) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AAAA;AACA;;;;AAGO,eAAe;IAClB,IAAI;QACA,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;YAC3B,QAAQ,IAAI,CAAC;YACb,OAAO,gJAAY,CAAC,IAAI,CAAC,EAAE;QAC/B;QAEA,MAAM,OAAO,MAAM,mIAAE,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC;YACvC,SAAS;gBAAC,IAAA,wKAAI,EAAC,0IAAK,CAAC,SAAS;aAAE;YAChC,MAAM;gBACF,QAAQ;YACZ;QACJ;QAEA,MAAM,aAAa,KAAK,GAAG,CAAC,CAAA,OAAQ,CAAC;gBACjC,GAAG,IAAI;gBACP,QAAQ,KAAK,MAAM,IAAI;oBAAE,MAAM;oBAAW,MAAM;oBAAU,QAAQ;gBAAG;YACzE,CAAC;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAY;QACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrE;AACJ;AAGO,eAAe,KAAK,OAAoB;IAC3C,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,MAAM,WAAW;YACb,OAAO,KAAK,KAAK;YACjB,MAAM,KAAK,IAAI;YACf,SAAS,KAAK,OAAO;YACrB,SAAS,KAAK,OAAO;YACrB,UAAU,KAAK,QAAQ;YACvB,YAAY,KAAK,WAAW;YAC5B,WAAW,KAAK,WAAW;YAC3B,MAAM,KAAK,IAAI;YACf,aAAa,KAAK,YAAY;YAC9B,WAAW,KAAK,SAAS;YACzB,UAAU,KAAK,SAAS;QAC5B;QAEA,MAAM,OAAO,MAAM,mIAAE,CAAC,MAAM,CAAC,0IAAK,EAAE,MAAM,CAAC,UAAU,SAAS;QAC9D,OAAO,gJAAY,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;IACpC,EAAE,OAAO,OAAY;QACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrE;AACJ"}}]
}